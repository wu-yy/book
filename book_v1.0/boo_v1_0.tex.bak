\documentclass[11pt,a4paper,openany]{book}
\usepackage{ctex}
\usepackage{fontenc,xunicode,xltxtra}
\usepackage{changepage}
\usepackage{amsmath,amsthm}
\usepackage{amssymb}
\usepackage{lmodern}
\usepackage{graphicx}
\usepackage{epstopdf}
\usepackage{enumerate}
\usepackage[english]{babel}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{latexsym}
\usepackage{multirow}
\usepackage{bigdelim}
\usepackage{color}
\usepackage{graphicx}
\usepackage{wrapfig}
\usepackage{picinpar}
\usepackage{picins}
\usepackage{float}
\usepackage{clrscode}
\usepackage{algorithm} %format of the algorithm
\usepackage{algorithmic} %format of the algorithm
\usepackage{subfigure}
\usepackage{xeCJK}
\usepackage{varwidth}
\usepackage{caption}
\usepackage{lipsum}
\usepackage{framed}
\usepackage[colorlinks]{hyperref}

\setCJKmainfont[BoldFont=SimHei,ItalicFont=KaiTi]{宋体}
\setmonofont{宋体}
\setmainfont{Times New Roman}  %缺省英文字体

\XeTeXlinebreaklocale "zh"   % 针对中文进行断行
\XeTeXlinebreakskip = 0pt plus 1pt minus 0.1pt     % 给予TeX断行一定自由度
%\linespread{1.5}                                  % 1.5倍行距

\newfontfamily{\H}{SimHei}
\newfontfamily{\K}{KaiTi}
\newfontfamily{\S}{黑体}
\setCJKfamilyfont{hwxw}{STXinwei}                    %华文新魏  hwxw
\newcommand{\hwxw}{\CJKfamily{hwxw}}
\setCJKfamilyfont{hei}{SimHei}                       %黑体  hei
\newcommand{\hei}{\CJKfamily{hei}}
\setCJKfamilyfont{song}{SimSun}                      %宋体 song
\newcommand{\song}{\CJKfamily{song}}
\setCJKfamilyfont{kai}{KaiTi}                        %楷体  kai
\newcommand{\kai}{\CJKfamily{kai}}
\setCJKfamilyfont{fs}{FangSong}                      %仿宋 fsong
\newcommand{\fs}{\CJKfamily{fs}}

\newcommand{\xiaosihao}{\fontsize{12pt}{\baselineskip}\selectfont}  %字体大小
\newcommand{\wuhao}{\fontsize{10.5pt}{\baselineskip}\selectfont}

\captionsetup[figure]{name=图}
\captionsetup[table]{name=表}
\definecolor{shadecolor}{rgb}{0.92,0.92,0.92}

%\makeatletter
%\makeatother
\newtheorem{theorem}{\textbf{定理}}[section]
\newtheorem{defination}{\textbf{定义}}[section]
\newtheorem{property}{\textbf{性质}}[section]
\newtheorem{lemma}{\textbf{引理}}[section]
\newtheorem{coro}{\textbf{推论}}[section]
\newtheorem{sample}{\textbf{例}}[section]
\newtheorem{guess}{\textbf{猜想}}[section]
\renewcommand{\figurename}{图}
\floatname{algorithm}{算法}
\newcommand{\reffig}[1]{\textcolor{red}{图}\ref{#1}}

\usepackage{fancyhdr}
\pagestyle{fancy}
\fancyhf{}
\fancyhead[ER]{\rightmark} %奇数页与偶数页分别用字母 O，E 表示
\fancyhead[EL]{\leftmark}
\fancyhead[OL]{\rightmark}
\fancyhead[OR]{\leftmark}
\fancyfoot[LO,RE]{}
\fancyfoot[LE,RO]{-\,\thepage\,-}
\renewcommand{\headrulewidth}{0.4pt}
\renewcommand{\chaptermark}[1]{\markboth{\small 第\,\thechapter\,章\quad #1}{}}
\renewcommand{\sectionmark}[1]{\markright{\small\thesection\quad #1}{}}

\fancypagestyle{plain}{
     \fancyhf{}
     \fancyfoot[LO,RE]{}
     \fancyfoot[LE,RO]{-\,\thepage\,-}
     \renewcommand{\headrulewidth}{0pt}
}
\renewcommand\labelitemi{\ensuremath{\bullet}} % 原来定义为 \textbullet itemsize 黑色圆点
\usepackage{titlesec}
\titleformat{\chapter}{\centering\huge\hei}{第\,\thechapter\,章}{1em}{}[\vspace{-1cm}]
\begin{document}
%\pagestyle{plain}  %取消页码
\chapter{第一章}

\chapter{第二章}
\chapter{树}
\section{树的有关定义}
\subsection{基本定义}
\begin{defination}
树的基本定义\begin{description}
        \item[树] :一个不含任何回路的连通图, 用T 表示
        \item[树枝]: T中的边，称为T 的树枝
        \item[树叶] :T 中度为一的结点
      \end{description}
\end{defination}
\begin{defination}
设e是G的一条边，若$G'=G-e$比G的连通支数增加，则称e是G的一条割边。\\
\begin{figure}[H]
  \centering
  % Requires \usepackage{graphicx}
  \includegraphics[width=0.7\textwidth]{3_1.eps}\\
  \caption{}
\end{figure}
\end{defination}
\begin{theorem}
$e=(u,v)$是割边，当且仅当e不属于G的任何回路。\\
\textbf{证明:}\\
\begin{itemize}
  \item 充分性(反证法)：若$e=(u,v)$属于G的某个回路，则$G'=G-e$中仍存在u到v的道路，故结点u和v属于同一连通支，e不是割边。
  \item 必要性(反证法)：反之，若e不是割边，则$G'$和G
的连通支数一样，因此u和v仍然处在同一个连
通支，因此在图$G'$中存在道路$P(u,v)$ $$P(u,v)+e$$就是图G的一个回路.
\end{itemize}
\end{theorem}
\begin{theorem}
$e=(u,v)$是割边，当且仅当e不属于G的任何回路。\\
\end{theorem}
\textbf{小结论:}
\begin{itemize}
  \item \textcolor{red}{树的每条边都不属于任何回路}
  \item \textcolor{red}{因此树的每条边都是割边}
  \item \textcolor{red}{树是边数最少的连通图}
\end{itemize}
\subsection{树的等价性质}
\begin{theorem}
设T 是结点数为$n\geq2 $的树, 则下列性质等价:
\begin{enumerate}
  \item T连通且无回路
  \item T 连通且每条边都是割边
  \item T连通且有n-1 条边
  \item T 有n-1 条边且无回路
  \item T的任意两结点间有唯一道路
  \item T 无回路，但在任意两结点间加上一条边后恰有一个回路
\end{enumerate}
{\hwxw 依次证明上述定理的正确性：}
{\song
\begin{itemize}
  \item (1)T连通且无回路$\Rightarrow$(2)T连通且每条边都是割边\\
  \textbf{证明：}\\
  由定理$3.1.2$ ，$e=(u,v)$是割边$\Leftrightarrow$ e 不属于G的任何回路.
  \item (2)T 连通且每条边都是割边$\Rightarrow$ (3)T 连通且有n-1 条边\\
  \textbf{证明:}\\
  采用数学归纳法: 对结点数n 进行归纳。\\
  设m(T) 为树T 的边数，n(T) 为树T 的结点数。\\
  n=2 时, 结论显然成立;\\
  设$n\leq k$ 时,$m(T)=n(T)-1$ 成立。\\
  当n=k+1 时, 由于每条边都是割边, 因此图$G'=G - e$ 有两个连通支$T_1$和$T_2$。\\
  根据假设,$$ m(T_1)=n(T_1)-1,\quad m(T_2)=n(T_2)-1 \Rightarrow m(T)=m(T_1)=m(T_2)+1=n(T)-1$$
  \item (3)T 连通且有n-1条边$\Rightarrow$(4)T 有n-1 条边且无回路 \\
  \textbf{证明:}\\
  反证法: 假定T 有回路。\\
    设C 为其中一条含有k 个结点的初级回路，故回路内有k 条边。考察C 以外的$n-k $个结点, 为保持T 的连通性, 至少需要C 以外的n-k 条
    边。所以T 的边数至少为$k+(n-k)=n$ 条与T 有$n-1$ 条边矛盾，故假设不成立，即T 无回路。
  \item(4) T有$n-1$ 条边且无回路$\Rightarrow$ (5)T 的任意两结点间有唯一道路\\
  \textbf{证明：}\\
  首先证明任意两结点间道路的存在性(反证法) : 设$u,v$ 是T 的任
意两结点, 假设不存在道路$P(u,v)$ 则$u,v$ 属于两个连通支$T_1,T_2$。 由于$m=n-1$, 则至少有一个连通支的边数不少于结点数。不妨
设为$T_1,m(T_1)\geq n(T_1)$ 设$T_1$ 无回路，由性质(1)$\Rightarrow$ 性质(2)
$\Rightarrow$性质(3)，$m(T_1)=n(T_1)-1<n(T_1)$，矛盾。因此此时该连通支
$T_1$ 必存在回路, 与题目前提矛盾! 因此, $P(u,v)$ 存在。\\
其次证明任意两结点间道路的唯一性:\\
如图$3.2$, 若存在两条不同的道路$P(u,v), P'(u,v)$，则$P(u, v)\bigoplus P'(u, v)$
必存在回路。与题目假设矛盾。因此$P(u,v)$ 唯一。
\begin{figure}[H]
  \centering
  % Requires \usepackage{graphicx}
  \includegraphics[width=0.6\textwidth]{3.2.png}\\
  \caption{}
\end{figure}
\item (5)T的任意两结点间有唯一道路$\Rightarrow \quad $ (6)T 无回路, 但在任意两结点间
加上一条边后恰有一个回路\\
\textbf{证明：}\\
 首先证明T 无回路：\\
若T 有回路，则回路上任意两点之间至少有两条不同的道路，与
前提矛盾。\\
故T 无回路。\\
 其次证明在任意两结点间加上一条边e 后恰有一个回路：\\
设原来两结点之间的道路为P，则$P\bigcup e $即为一个回路。\\
故在任意两结点间加上一条边e 后恰有一个回路\\

\item (6)T 无回路, 但在任意两结点间加上一条边后恰有一个回路$\Rightarrow \quad$ (1)T
连通且无回路\\
\textbf{证明：}
 T 连通：因任意两结点间加上一条边后恰有一个回路，故原图中
任意两点间必然存在一条道路。\\
T 无回路：已知条件
\end{itemize}
}
\end{theorem}
\begin{theorem}
树T中一定存在树叶结点\\
{\song
\textbf{证明：}\\
T为连通图，故不存在度为零的结点。\\
假设T中不存在树叶结点，则意味着不存在度为
1的结点，则所有结点度均不小于2。
$$ m=\frac{1}{2}\sum_{v\in V(G)} d(v)\quad \Rightarrow \quad m \geq \frac{1}{2}\cdot 2n=n > n-1$$
容易看出：矛盾!\\
}
\end{theorem}
\begin{defination}
如果T是图G的支撑子图，而且又是一棵树，则称T是G的一棵\textcolor{red}{支撑树}，或称\textcolor{red}{生成树}，又简称为G的\textcolor{red}{树}。
\end{defination}
\subsection{余树的概念}
\begin{defination}
G中删掉T的各边后子图称为T的\textcolor{red}{余树},记为$\bar{T}$
\end{defination}

\section{基本关联矩阵及其性质}
{\hwxw 本节研究的范围是有向连通图。}\\
\begin{defination}
有向连通图$G = (V , E)$ 的关联矩阵$B $中划去任意节点$v_k$ 所
对应的行，得到一个$(n−1)\times m$ 的矩阵$B_k$, $B_k$ 称为G 的一个基本关联矩阵。
\begin{figure}[H]
  \centering
  % Requires \usepackage{graphicx}
  \includegraphics[width=0.6\textwidth]{3_3.eps}\\
  \caption{}
\end{figure}
\begin{equation}
B=\bordermatrix{%
       & e_1       & e_2     &e_3    &e_4  &e_5 &e_6\cr
v_1    & 1         & -1       &1     & 0 & 0 & 1\cr
v_2    & 0        & 0       &-1     & -1 & 0 & -1\cr
v_3    & -1         & 1       &0     &0 &1 &0
},
\end{equation}
\end{defination}
{\hwxw 下面我们来研究基本关联矩阵的性质。\\}
\begin{theorem}
有向图$G = (V , E)$ 关联矩阵B 的秩$ran(B) < n$。\\
{\song
\textbf{证明:}\\
关联矩阵特点：每一列都只有一个$1$和$-1$\\
n行全部相加\\
即n 个行向量线性相关，因此
$$ran B< n$$
证毕！
}
\end{theorem}
\begin{theorem}
设$B_0$是有向图G关联矩阵B的任意一k阶子方阵，则$det(B_0)$为$0,1$或$-1$\\
{\song
\textbf{证明:}\\
若$B_0$某列全零，则$det(B_0)＝0$\\
若$B_0$每列都有两个非零元，则$det(B_0)＝0$\\
若$B_0$存在某列只有一个非零元，则按该列展开可知$det(B_0)＝\pm det(B_1)$\\
依次类推，可证！
}
\end{theorem}

\begin{theorem}
设$B_0$是有向图G关联矩阵B的任意一k阶子方阵，则$det(B_0)$为$0,1$或$-1$\\
{\song
\textbf{证明:}\\
若$B_0$某列全零，则$det(B_0)＝0$\\
若$B_0$每列都有两个非零元，则$det(B_0)＝0$\\
若$B_0$存在某列只有一个非零元，则按该列展开可知$det(B_0)＝\pm det(B_1)$\\
依次类推，可证！
}
\end{theorem}

\begin{theorem}
设B是有向连通图G的关联矩阵，则$$ran B=n-1$$
{\song
\textbf{证明：}\\
设B中最少的线性相关行数为$l$\\
则$l\leq n$，其对应图中结点$v(i_1),v(i_2),\dots,v(i_l )$\\
\begin{equation*}
k_1\cdot b(i_1) +k_2\cdot b(i_2) +\cdots +k_l\cdot b(i_l) =O_m \quad (k_j\neq 0,\quad j=1,2,\cdots,l)
\end{equation*}
\begin{itemize}
  \item
  \begin{center}
    所有$b(i_j)$中，第$t(t=1,2,\cdots m)$个分量可能
  \end{center}
  \item
  \begin{center}
    所有$b(i_j)$中，第$t(t=1,2,\cdots m)$个分量可能
  \end{center}
  \item
  \begin{center}
    所有$b(i_j)$中，第$t(t=1,2,\cdots m)$个分量不可能
  \end{center}
\end{itemize}
  \begin{flushleft}
    否则，该分量最终不可能为$0$。
\end{flushleft}
\quad 这样，我们可以对矩阵B进行行、列交换，使前$l$行为线性相关的各行\\
\quad 再针对这$l$ 行中，有两个非零元的列换到前$r$列\\
则此$l$ 行中，其余$(m-r)$列将均为零元\\
\quad 此时矩阵B将变为
\begin{align*}
 B'= \begin{array}{lc}
\mbox{}&
\begin{array}{cc}r&m-r \end{array}\\
\begin{array}{c}l\\n-l\end{array}&
\left[\begin{array}{cc}
P&0\\
0&Q
\end{array}\right]
\end{array}
\quad \quad ran B=ran B'
\end{align*}
\quad 若$l <n$，则从$B'$可清楚看出，图G为两个连通支，这与
图G为连通图矛盾！\\
因此，一定有$l=n$
}
\end{theorem}
\begin{theorem}
设B是有向连通图G的关联矩阵，则$$ran B=n-1$$
\end{theorem}
\begin{theorem}
连通图G基本关联矩阵$B_k$的秩$$ran B_k=n-1$$
\end{theorem}
\begin{theorem}
设$B_k$为有向连通图G的基本关联矩阵，C为G中的一个回路。则C中各边所对应$B_k$的各列线性相关。\\
{\song
\textbf{证明：}\\
只需针对C为初级回路进行讨论即可\\
设C中含$l$个结点与$l$条边$(l<n)$，这$l$条边对应关联矩阵$B$中的$l$列，它们构成子阵$B(G_C)$  \\
\begin{figure}[H]
  \centering
  % Requires \usepackage{graphicx}
  \includegraphics[width=0.7\textwidth]{3.4.png}\\
  \caption{}
\end{figure}
\noindent C的关联矩阵为$l$ 阶方阵$B(C)$，据定理$3.2.5$ $$ran B(C)=l-1$$
说明$B(C)$的$l$列线性相关\\
观察$B(C)$与$B(G_C)$的关系：
{\hwxw
\begin{itemize}
  \item B(C)为$B(G_C)$的子阵，列数相同，行数不同
  \item C中各边只经过B(C)中的各结点，因此$B(G_C)$中其他结点对应各
行均为零
\end{itemize}
}
因此， $B(G_C)$的各列也线性相关！\\
因此，在$B_k$中，C对应各列也线性相关！\\
}
\end{theorem}
\begin{theorem}
设$B_k$为有向连通图G的基本关联矩阵，C为G中的一个回路。则C中各边所对应$B_k$的各列线性相关。\\
\end{theorem}
\begin{coro}
设H为连通图G的子图，如果H含有回路，
则H的\textcolor{red}{诸边}对应的G的基本关联矩阵各列线性相关。
\begin{figure}[H]
  \centering
  % Requires \usepackage{graphicx}
  \includegraphics[width=0.4\textwidth]{rank.png}\\
  \caption*{}
\end{figure}
\end{coro}
{\hwxw
思考：\\
有向连通图的基本关联矩阵，哪些列线性相关？\\
有向连通图的基本关联矩阵，哪些列线性不相关？\\
}
\begin{theorem}
令$B_k$是有向连通图G的基本关联矩阵，那么$B_k$的任意$n-1$阶子阵行列式非零的充要条件是其各列所对应的边构成G的一棵支撑树。
{\song
证明：\\
充分性:\\
设T为G的支撑树\\
子图T的基本关联矩阵$B_k(T)$是$n-1$阶子方阵,它的秩为$n-1$这意味着其行列式非零。\\
该子方阵恰好就是$B_k$的某个$n-1$阶子阵\\
即$B_k$所对应的该$n-1$阶行列式非零。\\
}
\end{theorem}
\begin{shaded}
{\hwxw
小结：\\
(1)有向连通图关联矩阵的秩\\
(2)有向连通图基本关联矩阵各列的线性相关性\\
(3)有向连通图基本关联矩阵同支撑树的关系\\
}
\end{shaded}

\section{支撑树的计数}
给定连通图G，其支撑树可以有多少个？\\
以某结点为根的支撑树可以有多少个？
\begin{figure}[H]
  \centering
  % Requires \usepackage{graphicx}
  \includegraphics[width=0.5\textwidth]{3_5.eps}\\
  \caption*{}
\end{figure}
\begin{theorem}
(Binet-Cauchy定理)已知两个矩阵$A=(a_{ij})_{m\times n}$
和$B=(b_{ij})_{n\times m}$，满足$m\leq n$，则$$ det(AB)=\sum_{i}(A_iB_i)$$
{\hwxw
其中$A_i$，$B_i$都是m阶行列式\\
$A_i$是从A中取不同的m列所成的行列式；\\
$B_i$是从B中取相应的m行构成的行列式；\\
结果为全部组合求和\\
}
\end{theorem}
\begin{sample}
已知$A=\left[
       \begin{array}{ccc}
         4 & 3 & 2 \\
         -2 & 4 & 3 \\
       \end{array}
     \right]
$\quad $B=\left[
           \begin{array}{cc}
             5 & 1 \\
             0 & 3 \\
             4 & 2 \\
           \end{array}
         \right]
$求$det(AB)$\\
解：\\
$AB=\left[
      \begin{array}{cc}
        28 & 17 \\
        2 & 16 \\
      \end{array}
    \right]
$\\
因此$det(AB)=28 \times 16-17\times 2=414$\\
\end{sample}
\begin{shaded}
\noindent 采用内比－柯西定理计算矩阵乘积的行列式通常比较复杂\\
其价值在于：揭示了乘积矩阵的行列式与各矩阵的子阵行列式之间的关系\\
连通图中不同支撑树的计数恰好利用了这种关系，从而可以用代数的方法很容易解决支撑树的计数问题
\end{shaded}
\subsection{支撑树的计数－有向连通图}
\begin{theorem}
设$B_k$的是有向连通图$G=(V,E)$的某一
基本关联矩阵，则G的不同树的数目是$$det(B_kB^T_k)$$
{\song
证明：设$B_k=(b_{ij})_{(n-1)\times m}$\\
由内比-柯西定理$$det(B_k B_k^T)=\sum_{i}|B_i||B_i^T|$$
其中$|B_i|$是$B_k$的某$n-1$阶子阵的行列式\\
$|B_i^T|$是对应的$B_i^T$的$n-1$阶阵的行列式\\
有$|B_i|=|B_i^T|$\\
因此可以得到$$det(B_k B_k^T)=\sum_{i}|B_i||B_i^T|=\sum_i|B_i|^{2}$$
由定理$3.2.9$，如果，则其所对应的边构成G的一棵树\\
再由定理$3.2.3$， $|B_i|$只能为$0,1$或$-1$\\
因此， $det(B_k b_k^T)$恰恰是G中不同树的数目\\
}
\end{theorem}
\begin{sample}
如图$3.5$
\begin{figure}[H]
  \centering
  % Requires \usepackage{graphicx}
  \includegraphics[width=0.5\textwidth]{3_5_1.eps}\\
  \caption{}
\end{figure}
$
B=\left[
    \begin{array}{ccccccc}
      v_1 & 1 & -1 & 1 & 0 & 0 & 1 \\
      v_2 & 0 & 0 & -1 & -1 &0 & -1 \\
      v_3 & -1 & 1 & 0 & 0 & 1 & 0 \\
      v_4 & 0 & 0 & 0 & 1 & -1 & 0 \\
      & e_1 & e_2 & e_3 & e_4 & e_5 & e_6 \\
    \end{array}
  \right]\quad \Rightarrow \quad
  B_4=\left[
    \begin{array}{ccccccc}
      v_1 & 1 & -1 & 1 & 0 & 0 & 1 \\
      v_2 & 0 & 0 & -1 & -1 &0 & -1 \\
      v_3 & -1 & 1 & 0 & 0 & 1 & 0 \\
      v_4 &  &  &  &  &  & \\
      & e_1 & e_2 & e_3 & e_4 & e_5 & e_6 \\
    \end{array}
  \right]
$ $$det(B_4 B_4^T=8)$$
\end{sample}
\subsection{含特定、不含特定边的计算方法}
\begin{enumerate}
  \item 计算G 中不含某特定边$e$ 的树的数目：
将该边删除即可！
  \item 计算G 中必定含特定边e 的树的数目：
将该边收缩即可！
\end{enumerate}
\section{无向连通图支撑树的计数}
{\hwxw 无向连通图的关联矩阵不存在-1 元素, 如何计算其支撑树的数目?}\\
对无向连通图G 的每边任给一个方向, 得到有向连通图$G'$, 则$G'$的
支撑树与G 的支撑树一一对应!\\
\section{有向连通图根树的计数}
\begin{defination}
根树：T 为有向树, 若T 中存在某结点v0 的负度为0, 其余结点负
度为1, 则称T 为以$v_0$ 为根的外向树, 或称根树, 用$\mathop{T}\limits^{\rightharpoonup}$ 表示。
例：
\begin{figure}[H]
  \centering
  % Requires \usepackage{graphicx}
  \includegraphics[width=0.5\textwidth]{3_6.eps}\\
  \caption*{}
\end{figure}
$\Rightarrow \quad B_0=\left[
                         \begin{array}{ccccc}
                           v_0 &  &  &  &  \\
                           v_1& -1 & 0 & 1 & 1\\
                           v_2 & 0 & 0 & -1 & 0 \\
                           v_3 & 0 & 0 & 0& -1 \\
                           v_4 & 0 & -1 & 0 & 0 \\
                          & e_1  & e_2 & e_3 & e_4 \\
                         \end{array}
                       \right]
$\\
{\hwxw 特点:除$v_0$外，每行只有一个-1}\\
\subsection{根树基本关联矩阵的性质和特点}
如果对根树的结点和边重新进行编号，使
每条边$e=(v_i,v_j)$都满足$v_i$的编号小于$v_j$的编号，
同时$e=(v_i,v_j)$的编号为$e_j$
\begin{figure}[H]
  \centering
  % Requires \usepackage{graphicx}
  \includegraphics[width=0.5\textwidth]{3_7.eps}\\
  \caption*{}
\end{figure}
$\Rightarrow \quad B_0'=\left[
                         \begin{array}{ccccc}
                           v_1& -1 & 0 & 0 & 0\\
                           v_2 & 0 & -1& 1 & 1 \\
                           v_3 & 0 & 0 & -1& 0 \\
                           v_4 & 0 & 0 & 0 & -1 \\
                          & e_1  & e_2 & e_3 & e_4 \\
                         \end{array}
                       \right]
$\\
{\hwxw 思考：为什么按照规则编号后，根树中根结点对应的
基本关联矩阵一定是上三角矩阵？\\}
\end{defination}
\begin{shaded}
特点：按照规则编号后, 根树中根结点对应的基本关联矩阵一定是上三
角矩阵。\\
非根树基本关联矩阵可调整为上三角矩阵, 且对角线上将出现“1”元素。\\
令${\mathop{B}\limits^{\rightharpoonup}}_k$ 表示有向连通图G 的基本关联矩阵$B_k$ 中全部1 元素改为0 后的
矩阵。相应地,G 的支撑树的基本关联矩阵, 可调整为上三角矩阵, 但原先的
“1”变为了“0”。\\
\indent 如果该树为非根树(行列式为零), 则对角线将出现“0”元素\\
\indent 如果该树为根树(行列式绝对值为“1”), 则对角线全部为“-1”元素
\end{shaded}
\subsection{根树的计算方法}
\textbf{回顾：}定理$3.3.2$\\
设$B_k$的是有向连通图$G=(V,E)$的某一
基本关联矩阵，则G的不同树的数目是$$det(B_kB^T_k)$$
\begin{theorem}
有向连通图G 中以$v_k$ 为根的根树数目是$$det(\mathop{B_k}\limits^{\rightharpoonup}B_k^T)$$
{\song
证明：\\
由比内-柯西定理$$det(\mathop{B_k}\limits^{\rightharpoonup}B_k^T)=\sum_{i}|\mathop{B_i}\limits^{\rightharpoonup}||B_i^T|$$
若$|B_i^T|\neq 0$, 说明这$n-1$ 条边构成了G 的一棵树\\
若$ \mathop{B_i}\limits^{\rightharpoonup} \neq 0$, 说明该树是以$v_k$ 为根的根树。\\
二者的乘积非零说明存在一棵vk 为根的根树。
由于遍历了所有$n-1$ 条边的组合, 因此$$det(\mathop{B_k}\limits^{\rightharpoonup}B_k^T)=\sum_{i}|\mathop{B_i}\limits^{\rightharpoonup}||B_i^T|$$
为以$v_k$ 为根的根树的数目
}
\end{theorem}
\subsection{含特定边、不含特定边的根树计算方法}
1. 如何计算以v0 为根结点不含某特定边e 的根树的数目?\\
\indent 作$G'=G-e$，计算$G'$的以$v_0$ 为根结点的根树的数目即可\\
2. 如何计算以$v_0$ 为根结点必含某特定边e 的根树的数目?\\
\begin{itemize}
  \item 将该边收缩为一点\\
\textcolor{red}{错误！}此方法未必得到根树！
  \item 先计算以$v_0$ 为根结点的根树数目, 再计算不含边e 的根树数目,
求差值即可。
  \item 其他计算方法:
设$e=(u, v)$, 将除e 之外所有以v 为终点的边都删掉得到$G'$, 然
后计算$G'$的以$v_0$ 为根结点的根树的数目即可
\end{itemize}
\section{回路矩阵与割集矩阵}




\end{document}
